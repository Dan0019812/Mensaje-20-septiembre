
<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Para Nicole — Un mensaje</title>
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&family=Montserrat:400,600&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-color: #F9EEF2;
    --accent: #d85b88;
    --soft: #f7d7e0;
    --text:#2b2b2b;
  }
  html,body{height:100%;margin:0;font-family: 'Montserrat', sans-serif;background: linear-gradient(180deg,#fff,#f9eef2);}
  .stage{
    position:relative;
    min-height:100vh;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:40px;
    box-sizing:border-box;
  }
  /* Background collage */
  .bg-layer{
    position:absolute;inset:0;pointer-events:none;
    background: radial-gradient(circle at 10% 20%, rgba(255,240,245,0.6), transparent 15%),
                radial-gradient(circle at 90% 80%, rgba(240,248,255,0.6), transparent 15%);
    z-index:0;
  }
  /* left pizza stylized */
  .pizza-canvas{
    position:absolute;
    left:4%;
    top:10%;
    width:360px;height:360px;
    filter: drop-shadow(0 8px 20px rgba(0,0,0,0.2));
    border-radius:16px;
    overflow:hidden;
    transform: rotate(-6deg);
    opacity:0.9;
  }
  /* right illustration */
  .couple-img{
    position:absolute;
    right:6%;
    top:8%;
    width:420px;height:420px;
    border-radius:16px;
    overflow:hidden;
    transform: rotate(4deg);
    opacity:0.95;
    box-shadow:0 12px 30px rgba(0,0,0,0.15);
  }
  /* soft frame */
  .frame{
    position:relative;
    z-index:2;
    width:100%;
    max-width:960px;
    background: rgba(255,255,255,0.6);
    border-radius:18px;
    padding:36px;
    box-sizing:border-box;
    text-align:center;
    backdrop-filter: blur(6px) saturate(120%);
    box-shadow: 0 10px 40px rgba(0,0,0,0.12);
  }
  h1{
    font-family: 'Dancing Script', cursive;
    font-size:44px;
    margin:8px 0 12px 0;
    color:var(--accent);
    letter-spacing:0.6px;
  }
  .subtitle{color:var(--text);opacity:0.8;margin-bottom:18px;}
  .message{
    margin:18px auto 10px;
    max-width:720px;
    color:var(--text);
    font-size:20px;
    line-height:1.6;
  }
  .para{
    opacity:0;
    transform: translateY(10px);
    transition: opacity 1.6s ease, transform 1.6s ease;
    font-size:20px;
    margin:18px 0;
    font-family: 'Dancing Script', cursive;
    color:#3b2b2b;
    text-shadow: 0 1px 0 rgba(255,255,255,0.6);
  }
  .para.visible{opacity:1;transform:none;}
  /* flower petals */
  .petal{
    position:absolute;
    width:24px;height:24px;
    pointer-events:none;
    z-index:3;
    will-change:transform,opacity;
    opacity:0.95;
  }
  /* center controls */
  .controls{
    margin-top:22px;
    display:flex;
    gap:12px;
    justify-content:center;
    align-items:center;
  }
  .btn{
    background:linear-gradient(180deg,var(--accent),#c94a7a);
    color:white;padding:10px 16px;border-radius:999px;border:none;
    font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(201,74,122,0.28);
  }
  .btn.ghost{background:transparent;color:var(--accent);border:2px solid rgba(216,91,136,0.14)}
  /* small footer */
  .footer{font-size:13px;color:#6b6b6b;margin-top:14px;}
  /* responsive */
  @media (max-width:900px){
    .pizza-canvas{width:220px;height:220px;left:-10%;top:8%;transform:rotate(-10deg);opacity:0.85;}
    .couple-img{width:260px;height:260px;right:-6%;top:6%;transform:rotate(8deg);opacity:0.9;}
    .frame{padding:22px;}
    h1{font-size:34px;}
    .para{font-size:18px;}
  }
</style>
</head>
<body>
<div class="stage">
  <div class="bg-layer"></div>

  <!-- canvases / images for decorative backgrounds -->
  <canvas id="pizzaCanvas" class="pizza-canvas" aria-hidden="true"></canvas>
  <img id="coupleImg" class="couple-img" src="./1000106346.jpg" alt="pareja ilustrada" aria-hidden="true">

  <div class="frame" role="main" aria-live="polite">
    <h1>Para Nicole</h1>
    <div class="subtitle">Un pequeño regalo con todo mi cariño</div>

    <div class="message" id="messageBox" aria-atomic="true">
      <!-- paragraphs will be injected -->
      <div class="para" id="p1">Sé que tengo muchos defectos, pero lo más perfecto que tengo en mi vida es a ti.</div>
      <div class="para" id="p2">Te amo muchísimo y quiero que nunca lo dudes: tú eres mi motivación y mis ganas de ser mejor cada día.</div>
      <div class="para" id="p3">Diría que te amo con mi cabeza, pero las ideas se olvidan; te diría que te amo con mi corazón, pero este muere.</div>
      <div class="para" id="p4">Así que te diré que te amo con toda mi alma, que estará a tu lado día a día.</div>
    </div>

    <div class="controls">
      <button id="playBtn" class="btn">Reproducir música</button>
      <button id="fullscreenBtn" class="btn ghost">Pantalla completa</button>
    </div>
    <div class="footer">Si la canción no se reproduce automáticamente, pulsa "Reproducir música".</div>
  </div>

  <!-- invisible YouTube iframe for audio -->
  <div id="ytHolder" style="position:fixed;left:-9999px;top:-9999px;width:1px;height:1px;overflow:hidden;">
    <iframe id="ytplayer" width="560" height="315"
      src="https://www.youtube.com/embed/_aZ5mRlnnZ8?autoplay=1&controls=0&rel=0&loop=1&modestbranding=1&playlist=_aZ5mRlnnZ8"
      frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
  </div>

</div>

<!-- SVG petals templates -->
<svg id="petalTemplates" style="display:none;">
  <symbol id="rose" viewBox="0 0 24 24">
    <path d="M12 2s3 2 2.5 5c0 0 2 1 2 4s-2 5-5 6-5-2-6-4 0-6 0-6S9 2 12 2z" fill="#d85b88"/>
  </symbol>
  <symbol id="tulip" viewBox="0 0 24 24">
    <path d="M12 2s3 1 4 4c0 0 2 0 3 2s-1 6-4 8-6 0-7-2 0-6 0-6S9 2 12 2z" fill="#f2a3c1"/>
  </symbol>
</svg>

<script>
/* ====== Setup images (pizza into canvas stylized) ====== */
const pizzaSrc = './1000094308.jpg'; // pizza photo provided
const pizzaCanvas = document.getElementById('pizzaCanvas');
const pctx = pizzaCanvas.getContext('2d');
const pizzaImg = new Image();
pizzaImg.src = pizzaSrc;
pizzaImg.onload = () => {
  // resize canvas to match displayed size
  const w = pizzaCanvas.clientWidth;
  const h = pizzaCanvas.clientHeight;
  pizzaCanvas.width = w;
  pizzaCanvas.height = h;
  // draw image scaled
  pctx.drawImage(pizzaImg,0,0,w,h);
  // apply cartoon filter: posterize + edge overlay
  posterize(pctx, w, h, 6);
  edgeOverlay(pctx, w, h);
};

/* Posterize function (reduce colors) */
function posterize(ctx,w,h,levels){
  const img = ctx.getImageData(0,0,w,h);
  const d = img.data;
  for(let i=0;i<d.length;i+=4){
    d[i] = Math.floor(d[i]/255*levels)/levels*255;     // r
    d[i+1] = Math.floor(d[i+1]/255*levels)/levels*255; // g
    d[i+2] = Math.floor(d[i+2]/255*levels)/levels*255; // b
    // slightly boost saturation:
    const avg = (d[i]+d[i+1]+d[i+2])/3;
    d[i] = Math.min(255, d[i] + (d[i]-avg)*0.35);
    d[i+1] = Math.min(255, d[i+1] + (d[i+1]-avg)*0.35);
    d[i+2] = Math.min(255, d[i+2] + (d[i+2]-avg)*0.35);
  }
  ctx.putImageData(img,0,0);
}

/* Simple Sobel-like edge detection overlay */
function edgeOverlay(ctx,w,h){
  const src = ctx.getImageData(0,0,w,h);
  const out = ctx.createImageData(w,h);
  const s = src.data;
  const o = out.data;
  const get = (x,y, c)=> {
    if(x<0||x>=w||y<0||y>=h) return 0;
    return s[(y*w + x)*4 + c];
  };
  for(let y=0;y<h;y++){
    for(let x=0;x<w;x++){
      // compute luminance gradients
      const gx = (
        -1*get(x-1,y-1,0) + 1*get(x+1,y-1,0)
        -2*get(x-1,y,0)   + 2*get(x+1,y,0)
        -1*get(x-1,y+1,0) + 1*get(x+1,y+1,0)
      );
      const gy = (
        -1*get(x-1,y-1,0) -2*get(x,y-1,0) -1*get(x+1,y-1,0)
         +1*get(x-1,y+1,0) +2*get(x,y+1,0) +1*get(x+1,y+1,0)
      );
      const g = Math.min(255, Math.abs(gx)+Math.abs(gy));
      const idx=(y*w+x)*4;
      // darken edges slightly
      o[idx]=s[idx]; o[idx+1]=s[idx+1]; o[idx+2]=s[idx+2]; o[idx+3]=255;
      if(g>40){
        o[idx]=Math.max(0, s[idx]-g);
        o[idx+1]=Math.max(0,s[idx+1]-g*0.7);
        o[idx+2]=Math.max(0,s[idx+2]-g*0.6);
      }
    }
  }
  ctx.putImageData(out,0,0);
}

/* ====== Petals / tulips animation ====== */
const stage = document.querySelector('.stage');
const templates = document.getElementById('petalTemplates');

function spawnPetal(kind){
  const use = document.createElementNS('http://www.w3.org/2000/svg','svg');
  use.setAttribute('class','petal');
  use.setAttribute('width','36');
  use.setAttribute('height','36');
  use.style.left = (Math.random()*100) + '%';
  use.style.top = (-10 - Math.random()*6) + '%';
  use.style.transform = `translateY(-20px) rotate(${Math.random()*360}deg)`;
  use.style.opacity = 0.95 - Math.random()*0.35;
  use.innerHTML = (kind==='rose') ? '<use href="#rose" />' : '<use href="#tulip" />';
  stage.appendChild(use);
  // animate
  const duration = 8000 + Math.random()*12000;
  const endX = (Math.random()*80)-40;
  const startLeft = parseFloat(use.style.left);
  const endLeft = startLeft + endX/ (window.innerWidth>600?1:1.5);
  use.animate([
    {transform:`translateY(0px) rotate(${Math.random()*360}deg)`, left:use.style.left, opacity:use.style.opacity},
    {transform:`translateY(${window.innerHeight + 100}px) rotate(${Math.random()*720}deg)`, left:endLeft+'%', opacity:0.05}
  ],{duration:duration, easing:'linear'});
  setTimeout(()=>use.remove(), duration+100);
}

// continuous spawner
setInterval(()=> spawnPetal(Math.random()>0.4?'rose':'tulip'), 600);

/* ====== Paragraph timings (total ~300s) ====== */
/* We'll reveal 4 paragraphs spaced across ~5 minutes */
const p1 = document.getElementById('p1');
const p2 = document.getElementById('p2');
const p3 = document.getElementById('p3');
const p4 = document.getElementById('p4');

// timings in ms (adjustable)
const total = 300000; // 5 minutes
// set delays roughly: p1 at 5s, p2 at ~75s, p3 at ~165s, p4 at ~225s
setTimeout(()=>p1.classList.add('visible'), 5000);
setTimeout(()=>p2.classList.add('visible'), 75000);
setTimeout(()=>p3.classList.add('visible'), 165000);
setTimeout(()=>p4.classList.add('visible'), 225000);
// additionally, gentle pulsing of final frame
setTimeout(()=> {
  document.querySelector('.frame').style.transition='transform 1s ease';
  document.querySelector('.frame').style.transform='scale(1.01)';
  setTimeout(()=>document.querySelector('.frame').style.transform='scale(1)',800);
}, 260000);

/* ====== YouTube player handling ====== */
const playBtn = document.getElementById('playBtn');
const ytIframe = document.getElementById('ytplayer');

function tryPlayYT(){
  // try to play by reloading iframe with autoplay=1 (some browsers allow if mute)
  try{
    // attempt to postMessage to iframe (YouTube may ignore if not ready)
    ytIframe.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
  }catch(e){
    // fallback: reload src to nudge autoplay
    const src = ytIframe.src;
    ytIframe.src = src.includes('autoplay=1') ? src : src + '&autoplay=1';
  }
}

playBtn.addEventListener('click', ()=> {
  tryPlayYT();
  playBtn.disabled=true;
  playBtn.textContent='Música en reproducción';
});

/* also try autoplay on load (may be blocked) */
window.addEventListener('load', ()=> {
  setTimeout(tryPlayYT, 800);
});

/* fullscreen toggle */
const fsBtn = document.getElementById('fullscreenBtn');
fsBtn.addEventListener('click', ()=>{
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen().catch(()=>{});
  } else {
    document.exitFullscreen();
  }
});

/* Accessibility: allow keyboard to trigger play */
document.addEventListener('keydown', (e)=>{
  if(e.key===' ' || e.key==='Enter'){
    playBtn.click();
  }
});

/* Helpful note: if autoplay is blocked by browser, user can press the Reproducir música button. */
</script>
</body>
</html>
